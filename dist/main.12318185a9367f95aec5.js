(()=>{"use strict";var e={804:(e,t,n)=>{e.exports=n.p+"334c08e51937cf761628.jpg"}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var c=t[a]={exports:{}};return e[a](c,c.exports,n),c.exports}n.p="",(()=>{var e=n(804);const t=document.querySelector(".listContainer"),a="cuSc6vNb8MIaUDaK4qjK",r=document.querySelector(".nav-wrapper").querySelector(".nav-element"),c="https://api.punkapi.com/v2/",o="https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/";async function s(e="",t="",n,a=!1){let r;return r=t&&"GET"!==t?await fetch(a?o+e:c+e,{method:t||"GET",body:JSON.stringify(n),headers:{"Content-type":"application/json; charset=UTF-8"}}):await fetch(a?o+e:c+e,{method:t||"GET",headers:{"Content-type":"application/json; charset=UTF-8"}}),a?r.text():r.json()}const i=(e="")=>{const t=`An error has ocurred ${e}`;console.log(t)},l=async e=>{try{const t=await s(`${a}/comments?item_id=${e}`,"GET",{},!0),n=JSON.parse(t);if(n.error)throw new Error(n.error);return JSON.parse(t)}catch(e){return i(e),[]}},d=(document.querySelector(".detailsBtn"),document.querySelector(".overlay")),m=document.querySelector(".pop-up"),p=e=>{d.classList.add("hidden"),e.removeEventListener("click",p)},u=(e=(()=>{}),n)=>{const r=Array.from(t.children);r.forEach(((c,o)=>{const u=r[o].querySelector(".detailsBtn"),h=r[o].querySelector(".fa-heart"),y=r[o].querySelector(".commentBtn");u.addEventListener("click",(()=>e(n[o],o))),h.addEventListener("click",(()=>(async e=>{try{const n={item_id:e.id};await s(`${a}/likes`,"POST",n,!0);const r=t.children[e.id-1].querySelector(".beer-title").querySelector(".likes"),c=Number(r.getElementsByTagName("p")[0].textContent);r.children[1].innerHTML=`<p>${c+1}</p>`}catch(e){i(e)}})())),y.addEventListener("click",(()=>(async e=>{d.classList.remove("hidden");const t=await l(e.id),n=0===t.length||void 0===t.length?0:t.length;m.innerHTML=`\n                \n                <div class="pop-content">\n                  <h3>Add Comment</h3>\n                  <div class="beer-title">\n                  <div class="comment"><i class="fa fa-calculator"></i> <p>Total of comments ${n}</p></div>\n                    <button class="close-pop-up" >&times;</button>\n                    <form id="addPost" action="/" method="">\n                      <input type="text" id="fname" name="fname" placeholder="Your Name"><br><br>\n                      <textarea name="textarea" id="comment" placeholder="Your insight"></textarea>\n                      <input type="submit" class="add" id="add" value="Comment">\n                    </form>                  \n                  </div>\n                  \n                </div>`;const r=document.getElementById("addPost"),c=document.querySelector(".close-pop-up");c.addEventListener("click",(()=>p(c))),r.addEventListener("submit",(t=>(async(e,t)=>{try{e.preventDefault();const n=document.querySelector("#addPost"),r={item_id:t.id,username:n.children[0].value,comment:document.querySelector("#comment").value};await s(`${a}/comments`,"POST",r,!0),n.children[0].value="",document.querySelector("#comment").value="",window.alert("Comment added!")}catch(e){i(e)}})(t,e)))})(n[o])))}))};let h;(()=>{const n=new Image;n.src=e,n.alt="logo",document.querySelector(".logo-container").appendChild(n),(new class{refresh=async()=>{try{return await s("beers")}catch(e){return i(e),[]}};openPopup=async e=>{d.classList.remove("hidden");const t=await l(e.id);m.innerHTML=`\n                <button class="close-pop-up" >&times;</button>\n                <div class="pop-content">\n                  <img class="image" src="${e.image_url}" alt="${e.name}"></img>\n                  <div class="beer-title">\n                    <p>${e.name}</p>\n                    <p class="likes"><i class="far fa-heart"></i> 5</p>\n                  </div>\n                  <div class="comments-display">\n                    <h5>Comments (${t.length})</h5>\n                  </div>\n                </div>`;const n=document.querySelector(".close-pop-up");n.addEventListener("click",(()=>p(n))),((e=[])=>{const t=document.querySelector(".comments-display");e.forEach((e=>{const{username:n,comment:a,creation_date:r}=e,c=`<p>${r} ${n}:${a}</p>`;t.innerHTML+=c}))})(t)};numberOfItems=(e=0)=>{const t=`<p>Beers Available(${e})</p>`;r.innerHTML=t};likesNumber=async()=>{try{const e=await s(`${a}/likes`,"GET",{},!0);return JSON.parse(e)}catch(e){return i(e),[]}};createApp=async()=>{try{const e=await s("","POST",{name:"newAppMiguel"},!0);a=e}catch(e){i(e),a=""}};async reloadHTML(){a||this.createApp();const e=await this.likesNumber(),n=await this.refresh();this.numberOfItems(n.length),t.innerHTML="",n.forEach((n=>{const{name:a,image_url:r,id:c}=n,o=e.find((e=>e.item_id===c)),s=o?o.likes:0;h=`\n            <li >\n              <img class="image" src="${r}" alt="${a}"></img>\n              <div class="beer-title">\n                <p>${a}</p>\n                <div class="likes"><i class="far fa-heart"></i> <p>${s}</p></div>\n              </div>\n              <button class="commentBtn" type="button" >COMMENT</button>\n              <button class="detailsBtn" type="button">DETAILS</button>\n            </li>`,t.innerHTML+=h})),u(this.openPopup,n)}}).reloadHTML()})()})()})();
//# sourceMappingURL=main.12318185a9367f95aec5.js.map